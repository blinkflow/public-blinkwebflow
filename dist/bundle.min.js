/*! For license information please see bundle.min.js.LICENSE.txt */
(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){var t,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function c(e,o,a,i){var c=o&&o.prototype instanceof l?o:l,s=Object.create(c.prototype);return n(s,"_invoke",function(e,n,o){var a,i,c,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,i=0,c=t,d.n=n,u}};function p(e,n){for(i=e,c=n,r=0;!f&&l&&!o&&r<s.length;r++){var o,a=s[r],p=d.p,y=a[2];e>3?(o=y===n)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=e<2&&p<a[1])?(i=0,d.v=n,d.n=a[1]):p<y&&(o=e<3||a[0]>n||n>y)&&(a[4]=e,a[5]=n,d.n=y,i=0))}if(o||e>1)return u;throw f=!0,n}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,y),i=s,c=y;(r=i<2?t:c)||!f;){a||(i?i<3?(i>1&&(d.n=-1),p(i,c)):d.n=c:d.v=c);try{if(l=2,a){if(i||(o="next"),r=a[o]){if(!(r=r.call(a,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,i<2&&(i=0)}else 1===i&&(r=a.return)&&r.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=t}else if((r=(f=d.n<0)?c:e.call(n,d))!==u)break}catch(e){a=t,i=1,c=e}finally{l=1}}return{value:r,done:f}}}(e,a,i),!0),s}var u={};function l(){}function s(){}function f(){}r=Object.getPrototypeOf;var d=[][a]?r(r([][a]())):(n(r={},a,(function(){return this})),r),p=f.prototype=l.prototype=Object.create(d);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,n(t,i,"GeneratorFunction")),t.prototype=Object.create(p),t}return s.prototype=f,n(p,"constructor",f),n(f,"constructor",s),s.displayName="GeneratorFunction",n(f,i,"GeneratorFunction"),n(p),n(p,i,"Generator"),n(p,a,(function(){return this})),n(p,"toString",(function(){return"[object Generator]"})),(e=function(){return{w:c,m:y}})()}function n(t,e,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}n=function(t,e,r,o){if(e)a?a(t,e,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[e]=r;else{var i=function(e,r){n(t,e,(function(t){return this._invoke(e,r,t)}))};i("next",0),i("throw",1),i("return",2)}},n(t,e,r,o)}function r(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,a(r.key),r)}}function a(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,n||"default");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}var i=function(){return t=function t(e){var n=e.token,r=e.storeDomain;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.token=n,this.storeDomain=r},n=[{key:"executeQuery",value:(i=e().m((function t(n){var r,o,a,i,c,u=arguments;return e().w((function(t){for(;;)switch(t.n){case 0:if(r=u.length>1&&void 0!==u[1]?u[1]:{},this.token&&this.storeDomain){t.n=1;break}return console.error("[Blink] Shopify instance is not initialized."),t.a(2);case 1:return o="https://".concat(this.storeDomain,"/api/2025-04/graphql.json"),t.p=2,t.n=3,fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":this.token},body:JSON.stringify({query:n,variables:r})});case 3:if((a=t.v).ok){t.n=5;break}return t.n=4,a.json();case 4:throw i=t.v,console.error("Shopify API Error:",i),new Error("Shopify GraphQL error: ".concat(a.status));case 5:return t.n=6,a.json();case 6:return t.a(2,t.v);case 7:throw t.p=7,c=t.v,console.error("Shopify API Error:",c.message),c;case 8:return t.a(2)}}),t,this,[[2,7]])})),c=function(){var t=this,e=arguments;return new Promise((function(n,o){var a=i.apply(t,e);function c(t){r(a,n,o,c,u,"next",t)}function u(t){r(a,n,o,c,u,"throw",t)}c(void 0)}))},function(t){return c.apply(this,arguments)})}],n&&o(t.prototype,n),a&&o(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,a,i,c}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f(r.key),r)}}function s(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function f(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}var d=function(){return s((function t(){u(this,t)}),null,[{key:"set",value:function(t,e,n){var r=Date.now()+n;localStorage.setItem(t,JSON.stringify({value:e,expires:r}))}},{key:"get",value:function(t){var e=localStorage.getItem(t);if(!e)return null;try{var n=JSON.parse(e),r=n.value,o=n.expires;return Date.now()>o?(localStorage.removeItem(t),null):r}catch(e){return localStorage.removeItem(t),null}}},{key:"remove",value:function(t){localStorage.removeItem(t)}}])}(),p=function(){return s((function t(){u(this,t)}),null,[{key:"format",value:function(t,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"{{amount}}{{currency_code}}")||"${{amount}}";return n=(n=n.replace("{{amount}}",parseFloat(t).toFixed(2))).replace("{{currency_code}}",e||"")}}])}();function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){v(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function v(t,e,n){return(e=O(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return g(l,"_invoke",function(n,r,o){var a,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,u=t,d.n=n,i}};function p(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,a=s[e],p=d.p,y=a[2];n>3?(o=y===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<y&&(o=n<3||a[0]>r||r>y)&&(a[4]=n,a[5]=r,d.n=y,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,y),c=s,u=y;(e=c<2?t:u)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(e){a=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,a),!0),l}var i={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(g(e={},r,(function(){return this})),e),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,g(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,g(f,"constructor",l),g(l,"constructor",u),u.displayName="GeneratorFunction",g(l,o,"GeneratorFunction"),g(f),g(f,o,"Generator"),g(f,r,(function(){return this})),g(f,"toString",(function(){return"[object Generator]"})),(b=function(){return{w:a,m:d}})()}function g(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}g=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){g(t,e,(function(t){return this._invoke(e,n,t)}))};a("next",0),a("throw",1),a("return",2)}},g(t,e,n,r)}function w(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=k(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function S(t){return function(t){if(Array.isArray(t))return C(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||k(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t,e){if(t){if("string"==typeof t)return C(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(t,e):void 0}}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function P(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function _(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){P(a,r,o,i,c,"next",t)}function c(t){P(a,r,o,i,c,"throw",t)}i(void 0)}))}}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,O(r.key),r)}}function O(t){var e=function(t,e){if("object"!=y(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==y(e)?e:e+""}var T=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.shopifyClient=e,this.currentProducts={},this._productCacheKey="blink_products",this._productCacheTTL=6e5},e=[{key:"fetchAllProductsOnPage",value:(o=_(b().m((function t(){var e,n,r,o,a,i,c,u=this,l=arguments;return b().w((function(t){for(;;)switch(t.n){case 0:e=(l.length>0&&void 0!==l[0]?l[0]:null)||Array.from(document.querySelectorAll("[data-bf-product-id]")).map((function(t){return t.getAttribute("data-bf-product-id")})).filter(Boolean),n=S(new Set(e)),r=d.get(this._productCacheKey)||{},o=n.filter((function(t){return!r[t]})),a=w(n);try{for(a.s();!(i=a.n()).done;)c=i.value,r[c]&&(this.currentProducts[c]=r[c])}catch(t){a.e(t)}finally{a.f()}return t.n=1,Promise.all(o.map(function(){var t=_(b().m((function t(e){var n,r;return b().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,u.fetchAndStoreProduct(e);case 1:(n=t.v)&&(u.currentProducts[e]=n),t.n=3;break;case 2:t.p=2,r=t.v,console.error("[Blink] Failed to fetch product ".concat(e,":"),r);case 3:return t.a(2)}}),t,null,[[0,2]])})));return function(e){return t.apply(this,arguments)}}()));case 1:d.set(this._productCacheKey,h(h({},r),this.currentProducts),this._productCacheTTL);case 2:return t.a(2)}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"fetchAndStoreProduct",value:(r=_(b().m((function t(e){var n;return b().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,this.shopifyClient.executeQuery("\n        query Products($id: ID!) @inContext(language: EN) {\n          node(id: $id) {\n            ... on Product {\n              id\n              title\n              handle\n              description\n              descriptionHtml\n              priceRange {\n                minVariantPrice { amount currencyCode }\n                maxVariantPrice { amount currencyCode }\n              }\n              compareAtPriceRange {\n                minVariantPrice { amount currencyCode }\n                maxVariantPrice { amount currencyCode }\n              }\n              options {\n                name\n                optionValues {\n                  id\n                  name\n                  swatch {\n                    color\n                    image {\n                      id\n                      alt\n                      previewImage {\n                        altText\n                        url\n                      }\n                    }\n                  }\n                }\n              }\n              images(first: 100) {\n                edges {\n                  node {\n                    src\n                    altText\n                    id\n                    width\n                    height\n                  }\n                }\n              }\n              collections(first: 250) {\n                edges {\n                  node {\n                    id\n                    title\n                    metafields(identifiers: []) {\n                      id\n                      namespace\n                      key\n                      value\n                      reference {\n                        __typename\n                        ... on MediaImage {\n                          alt\n                          image { url }\n                        }\n                      }\n                      type\n                      description\n                    }\n                    handle\n                    description\n                    descriptionHtml\n                    image { src }\n                  }\n                }\n              }\n              vendor\n              productType\n              tags\n              requiresSellingPlan\n              variants(first: 100) {\n                edges {\n                  node {\n                    id\n                    product { id title vendor }\n                    title\n                    sku\n                    barcode\n                    price { amount currencyCode }\n                    unitPrice { amount currencyCode }\n                    compareAtPrice { amount currencyCode }\n                    image { src altText id width height }\n                    selectedOptions { name value }\n                    availableForSale\n                    currentlyNotInStock\n                    quantityAvailable\n                    product { id title vendor }\n                    metafields(identifiers: []) {\n                      id\n                      namespace\n                      key\n                      value\n                      reference {\n                        __typename\n                        ... on MediaImage {\n                          alt\n                          image { url }\n                        }\n                      }\n                      type\n                      description\n                    }\n                    weight\n                    weightUnit\n                    sellingPlanAllocations(first: 10) {\n                      edges {\n                        node {\n                          sellingPlan {\n                            id\n                            name\n                            description\n                            checkoutCharge { type value }\n                            recurringDeliveries\n                            options { name value }\n                          }\n                          priceAdjustments {\n                            price { amount currencyCode }\n                            compareAtPrice { amount currencyCode }\n                            perDeliveryPrice { amount currencyCode }\n                            unitPrice { amount currencyCode }\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n              sellingPlanGroups(first: 10) {\n                edges {\n                  node {\n                    appName\n                    name\n                    sellingPlans(first: 10) {\n                      edges {\n                        node {\n                          id\n                          name\n                          description\n                          recurringDeliveries\n                          options { name value }\n                          priceAdjustments {\n                            orderCount\n                            adjustmentValue {\n                              __typename\n                              ... on SellingPlanPercentagePriceAdjustment {\n                                adjustmentPercentage\n                              }\n                              ... on SellingPlanFixedAmountPriceAdjustment {\n                                adjustmentAmount { amount currencyCode }\n                              }\n                              ... on SellingPlanFixedPriceAdjustment {\n                                price { amount currencyCode }\n                              }\n                            }\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n        ",{id:e});case 1:if(!((n=t.v)&&n.data&&n.data.node)){t.n=2;break}return t.a(2,n.data.node);case 2:return t.a(2,null)}}),t,this)}))),function(t){return r.apply(this,arguments)})}],e&&j(t.prototype,e),n&&j(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function A(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return E(l,"_invoke",function(n,r,o){var a,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,u=t,d.n=n,i}};function p(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,a=s[e],p=d.p,y=a[2];n>3?(o=y===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<y&&(o=n<3||a[0]>r||r>y)&&(a[4]=n,a[5]=r,d.n=y,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,y),c=s,u=y;(e=c<2?t:u)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(e){a=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,a),!0),l}var i={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(E(e={},r,(function(){return this})),e),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,E(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,E(f,"constructor",l),E(l,"constructor",u),u.displayName="GeneratorFunction",E(l,o,"GeneratorFunction"),E(f),E(f,o,"Generator"),E(f,r,(function(){return this})),E(f,"toString",(function(){return"[object Generator]"})),(A=function(){return{w:a,m:d}})()}function E(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}E=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){E(t,e,(function(t){return this._invoke(e,n,t)}))};a("next",0),a("throw",1),a("return",2)}},E(t,e,n,r)}function x(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function F(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){x(a,r,o,i,c,"next",t)}function c(t){x(a,r,o,i,c,"throw",t)}i(void 0)}))}}function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,D(r.key),r)}}function D(t){var e=function(t,e){if("object"!=I(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==I(e)?e:e+""}var L=function(){return t=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"blink_cart";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.shopifyClient=e,this.productManager=n,this._cartStorageKey=r,this._cart=null,this.cartId=null,this._templates={},this._moneyFormat="{{amount}}{{currency_code}}",this._cartCacheTTL=144e5,this.onCartChange=null},e=[{key:"init",value:(f=F(A().m((function t(){var e;return A().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,this._fetchShopMoneyFormat();case 1:t.p=1,(e=d.get(this._cartStorageKey))&&(this._cart=e,this.cartId=this._cart.id,console.info("[Blink] Cart loaded from localStorage:",this._cart)),t.n=3;break;case 2:return t.p=2,t.v,console.warn("[Blink] Invalid or expired cart, resetting..."),t.n=3,this.clearCart();case 3:return t.a(2)}}),t,this,[[1,2]])}))),function(){return f.apply(this,arguments)})},{key:"_fetchShopMoneyFormat",value:(s=F(A().m((function t(){var e,n,r,o,a;return A().w((function(t){for(;;)switch(t.n){case 0:if(!(r=d.get("blink_shop_info"))){t.n=3;break}return t.p=1,o=r,this._moneyFormat=o.moneyFormat||"{{amount}}{{currency_code}}",t.a(2);case 2:t.p=2,t.v;case 3:return t.n=4,this.shopifyClient.executeQuery("\n        {\n            shop {\n                name\n                moneyFormat\n            }\n        }\n        ");case 4:a=t.v,this._moneyFormat=(null==a||null===(e=a.data)||void 0===e||null===(e=e.shop)||void 0===e?void 0:e.moneyFormat)||"{{amount}}{{currency_code}}",null!=a&&null!==(n=a.data)&&void 0!==n&&n.shop&&d.set("blink_shop_info",{shopName:a.data.shop.name,moneyFormat:a.data.shop.moneyFormat},36e5);case 5:return t.a(2)}}),t,this,[[1,2]])}))),function(){return s.apply(this,arguments)})},{key:"addToCart",value:(l=F(A().m((function t(e){var n,r,o,a;return A().w((function(t){for(;;)switch(t.n){case 0:if(n=e.variantId,r=e.quantity,o=void 0===r?1:r,this._cart){t.n=3;break}return t.n=1,this._createCart(n,o);case 1:return a=t.v,this.cartId=a.id,t.n=2,this.refreshCart();case 2:case 5:return t.a(2,this._cart);case 3:return t.n=4,this._addToExistingCart(n,o);case 4:return t.n=5,this.refreshCart();case 6:return t.a(2)}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"_createCart",value:(u=F(A().m((function t(e,n){var r,o;return A().w((function(t){for(;;)switch(t.n){case 0:return r={input:{lines:[{quantity:n,merchandiseId:e}]}},t.n=1,this.shopifyClient.executeQuery("\n            mutation cartCreate($input: CartInput!) {\n                cartCreate(input: $input) {\n                 cart {\n                    id\n                }\n                userErrors {\n                    field\n                    message\n                }\n                }\n            }\n            ",r);case 1:if(!((o=t.v).userErrors&&o.userErrors.length>0)){t.n=2;break}throw console.error("[Blink] Shopify user errors:",o.userErrors),new Error("Failed to create cart: "+o.userErrors[0].message);case 2:return t.a(2,o.data.cartCreate.cart)}}),t,this)}))),function(t,e){return u.apply(this,arguments)})},{key:"_addToExistingCart",value:(c=F(A().m((function t(e,n){var r,o;return A().w((function(t){for(;;)switch(t.n){case 0:return r={cartId:this.cartId,lines:[{quantity:n,merchandiseId:e}]},t.n=1,this.shopifyClient.executeQuery("\n            mutation cartLinesAdd($cartId: ID!, $lines: [CartLineInput!]!) {\n                cartLinesAdd(cartId: $cartId, lines: $lines) {\n                cart {\n                    id\n                }\n                userErrors {\n                    field\n                    message\n                }\n                }\n            }\n            ",r);case 1:if(!((o=t.v).data.cartLinesAdd.userErrors&&o.data.cartLinesAdd.userErrors.length>0)){t.n=2;break}throw console.error("[Blink] Shopify user errors:",o.data.cartLinesAdd.userErrors),new Error("Failed to add to cart: "+o.data.cartLinesAdd.userErrors[0].message);case 2:return t.a(2,o.data.cartLinesAdd.cart)}}),t,this)}))),function(t,e){return c.apply(this,arguments)})},{key:"fetchCart",value:(i=F(A().m((function t(e){var n,r;return A().w((function(t){for(;;)switch(t.n){case 0:return n={cartId:e},t.n=1,this.shopifyClient.executeQuery("\n            query getCart($cartId: ID!) {\n            cart(id: $cartId) {\n                id\n                checkoutUrl\n                createdAt\n                updatedAt\n                totalQuantity\n\n                lines(first: 50) {\n                edges {\n                    node {\n                    id\n                    quantity\n                    attributes {\n                        key\n                        value\n                    }\n                    cost {\n                        amountPerQuantity {\n                        amount\n                        currencyCode\n                        }\n                        totalAmount {\n                        amount\n                        currencyCode\n                        }\n                    }\n                    merchandise {\n                        ... on ProductVariant {\n                        id\n                        title\n                        sku\n                        availableForSale\n                        quantityAvailable\n                        image {\n                            url\n                            altText\n                        }\n                        price {\n                            amount\n                            currencyCode\n                        }\n                        product {\n                            id\n                            title\n                            handle\n                            vendor\n                            featuredImage {\n                            url\n                            altText\n                            }\n                        }\n                        }\n                    }\n                    sellingPlanAllocation {\n                        sellingPlan {\n                        id\n                        name\n                        options {\n                            name\n                            value\n                        }\n                        }\n                    }\n                    }\n                }\n                }\n\n                estimatedCost {\n                subtotalAmount {\n                    amount\n                    currencyCode\n                }\n                totalAmount {\n                    amount\n                    currencyCode\n                }\n                totalTaxAmount {\n                    amount\n                    currencyCode\n                }\n                }\n            }\n            }\n        ",n);case 1:if(!(r=t.v).errors){t.n=2;break}return console.error("[Blink] Error fetching cart:",r.errors),t.a(2,null);case 2:return t.a(2,r.data.cart)}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"clearCart",value:(a=F(A().m((function t(){var e,n;return A().w((function(t){for(;;)switch(t.n){case 0:if(!(this._cart&&this._cart.lines&&this._cart.lines.edges.length>0)){t.n=3;break}if(!((e=this._cart.lines.edges.map((function(t){return t.node.id}))).length>0)){t.n=1;break}return n={cartId:this.cartId,lineIds:e},t.n=1,this.shopifyClient.executeQuery("\n                mutation cartLinesRemove($cartId: ID!, $lineIds: [ID!]!) {\n                    cartLinesRemove(cartId: $cartId, lineIds: $lineIds) {\n                        cart { id }\n                        userErrors { field message }\n                    }\n                }\n            ",n);case 1:return t.n=2,this.refreshCart();case 2:t.n=4;break;case 3:return t.n=4,this.refreshCart();case 4:return t.a(2)}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"removeLineItem",value:(o=F(A().m((function t(e){var n;return A().w((function(t){for(;;)switch(t.n){case 0:return n={cartId:this.cartId,lineIds:[e]},t.n=1,this.shopifyClient.executeQuery("\n        mutation cartLinesRemove($cartId: ID!, $lineIds: [ID!]!) {\n            cartLinesRemove(cartId: $cartId, lineIds: $lineIds) {\n                cart { id }\n                userErrors { field message }\n            }\n        }\n    ",n);case 1:return t.a(2)}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"refreshCart",value:(r=F(A().m((function t(){return A().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,this.fetchCart(this.cartId);case 1:this._cart=t.v,d.set(this._cartStorageKey,this._cart,this._cartCacheTTL),this.cartId=this._cart.id,console.info("[Blink] Cart refreshed:",this._cart),"function"==typeof this.onCartChange&&this.onCartChange(this._cart);case 2:return t.a(2)}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&q(t.prototype,e),n&&q(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,a,i,c,u,l,s,f}();function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function M(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return N(l,"_invoke",function(n,r,o){var a,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,u=t,d.n=n,i}};function p(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,a=s[e],p=d.p,y=a[2];n>3?(o=y===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<y&&(o=n<3||a[0]>r||r>y)&&(a[4]=n,a[5]=r,d.n=y,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,y),c=s,u=y;(e=c<2?t:u)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(e){a=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,a),!0),l}var i={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(N(e={},r,(function(){return this})),e),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,N(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,N(f,"constructor",l),N(l,"constructor",u),u.displayName="GeneratorFunction",N(l,o,"GeneratorFunction"),N(f),N(f,o,"Generator"),N(f,r,(function(){return this})),N(f,"toString",(function(){return"[object Generator]"})),(M=function(){return{w:a,m:d}})()}function N(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}N=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){N(t,e,(function(t){return this._invoke(e,n,t)}))};a("next",0),a("throw",1),a("return",2)}},N(t,e,n,r)}function B(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function $(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){B(a,r,o,i,c,"next",t)}function c(t){B(a,r,o,i,c,"throw",t)}i(void 0)}))}}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Q(r.key),r)}}function Q(t){var e=function(t,e){if("object"!=G(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=G(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==G(e)?e:e+""}var H=function(){return t=function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cart=e,this._templates={},this.cart.onCartChange=function(){return n.renderCart()}},e=[{key:"init",value:(r=$(M().m((function t(){return M().w((function(t){for(;;)switch(t.n){case 0:this.closeCartDrawer(),this._setupCartTriggerButtons(),this._setupCheckoutButtons(),this._setupClearCartButtons(),this.renderCart();case 1:return t.a(2)}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"renderCart",value:function(){var t=this,e=this.cart._cart;document.querySelectorAll("[data-bf-cart]").forEach((function(n){var r=n.querySelector("[data-bf-cart-items-count]"),o=0,a=n.querySelector("[data-bf-line-items]");if(a){var i=t._templates.cartTemplate;if(!i){if(!(i=a.querySelector("[data-bf-line-item]")))return;t._templates.cartTemplate=i.cloneNode(!0)}i.style.display="none";var c=n.querySelector("[data-bf-empty-cart-message]");c&&(c.style.display="none"),a.querySelectorAll("[data-bf-line-item]").forEach((function(t){t!==i&&t.remove()}));var u=n.querySelector("[data-bf-cart-subtotal]"),l=n.querySelector("[data-bf-cart-total]");if(t.updateCartTotals(u,l,e),!e||!e.lines||!e.lines.edges.length)return i.style.display="none",void(c&&(c.style.display=""));e.lines.edges.forEach((function(e){o+=e.node.quantity;var n=e.node,r=i.cloneNode(!0);a.appendChild(r),r.style.display="";var c,u,l=r.querySelector("[data-bf-line-image]");l&&(l.src=null===(c=n.merchandise.image)||void 0===c?void 0:c.url,l.alt=(null===(u=n.merchandise.image)||void 0===u?void 0:u.altText)||"");var s=r.querySelector("[data-bf-line-title]");s&&(s.textContent=n.merchandise.product.title);var f=r.querySelector("[data-bf-line-selected-option]");f&&(f.textContent=n.merchandise.title);var d=r.querySelector("[data-bf-line-qty]");d&&(d.textContent=n.quantity);var y=r.querySelector("[data-bf-line-amount-per-qty]");y&&n.cost&&n.cost.amountPerQuantity&&(y.textContent=p.format(n.cost.amountPerQuantity.amount,n.cost.amountPerQuantity.currencyCode,t.cart._moneyFormat));var m=r.querySelector("[data-bf-line-total-amount]");m&&n.cost&&n.cost.totalAmount&&(m.textContent=p.format(n.cost.totalAmount.amount,n.cost.totalAmount.currencyCode,t.cart._moneyFormat));var h=r.querySelector("[data-bf-remove-line-item]");h&&(h.onclick=function(){var e=$(M().m((function e(r){return M().w((function(e){for(;;)switch(e.n){case 0:return r.preventDefault(),e.n=1,t.cart.removeLineItem(n.id);case 1:return e.n=2,t.cart.refreshCart();case 2:t.renderCart();case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}())})),r&&(r.textContent="(".concat(o,")"),r.style.display=o>0?"":"none"),e.lines.edges.length>1&&(i.style.display="")}}))}},{key:"updateCartTotals",value:function(t,e,n){var r,o,a,i;if(!n||null==n||!n.estimatedCost)return t&&(t.textContent=p.format(0,"USD")),void(e&&(e.textContent=p.format(0,"USD")));var c=(null==n||null===(r=n.estimatedCost)||void 0===r||null===(r=r.subtotalAmount)||void 0===r?void 0:r.amount)||0,u=(null==n||null===(o=n.estimatedCost)||void 0===o||null===(o=o.subtotalAmount)||void 0===o?void 0:o.currencyCode)||"USD",l=(null==n||null===(a=n.estimatedCost)||void 0===a||null===(a=a.totalAmount)||void 0===a?void 0:a.amount)||0,s=(null==n||null===(i=n.estimatedCost)||void 0===i||null===(i=i.totalAmount)||void 0===i?void 0:i.currencyCode)||"USD";t&&(t.textContent=p.format(c,u,this.cart._moneyFormat)),e&&(e.textContent=p.format(l,s,this.cart._moneyFormat))}},{key:"_setupCartTriggerButtons",value:function(){var t=this,e=document.querySelectorAll("[data-bf-cart-drawer-open]"),n=document.querySelectorAll("[data-bf-cart-drawer-close]");e.forEach((function(e){e.addEventListener("click",(function(){return t.openCartDrawer()}))})),n.forEach((function(e){e.addEventListener("click",(function(){return t.closeCartDrawer()}))}))}},{key:"closeCartDrawer",value:function(t){var e=t||document.querySelector("[data-bf-cart-drawer]");e&&(e.classList.remove("open"),e.setAttribute("aria-hidden","true"))}},{key:"openCartDrawer",value:function(t){var e=t||document.querySelector("[data-bf-cart-drawer]");e&&(e.classList.add("open"),e.setAttribute("aria-hidden","false"))}},{key:"_setupCheckoutButtons",value:function(){var t=this;document.querySelectorAll("[data-bf-checkout]").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),t.cart._cart&&t.cart._cart.checkoutUrl?window.location.href=t.cart._cart.checkoutUrl:console.warn("[Blink] No checkoutUrl available on cart.")}))}))}},{key:"_setupClearCartButtons",value:function(){var t=this;document.querySelectorAll("[data-bf-clear-cart]").forEach((function(e){e.addEventListener("click",function(){var e=$(M().m((function e(n){return M().w((function(e){for(;;)switch(e.n){case 0:return n.preventDefault(),e.n=1,t.cart.clearCart();case 1:return e.n=2,t.cart.refreshCart();case 2:t.renderCart();case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}}],e&&U(t.prototype,e),n&&U(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function K(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return R(l,"_invoke",function(n,r,o){var a,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,u=t,d.n=n,i}};function p(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,a=s[e],p=d.p,y=a[2];n>3?(o=y===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<y&&(o=n<3||a[0]>r||r>y)&&(a[4]=n,a[5]=r,d.n=y,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,y),c=s,u=y;(e=c<2?t:u)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(e){a=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,a),!0),l}var i={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(R(e={},r,(function(){return this})),e),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,R(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,R(f,"constructor",l),R(l,"constructor",u),u.displayName="GeneratorFunction",R(l,o,"GeneratorFunction"),R(f),R(f,o,"Generator"),R(f,r,(function(){return this})),R(f,"toString",(function(){return"[object Generator]"})),(K=function(){return{w:a,m:d}})()}function R(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}R=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){R(t,e,(function(t){return this._invoke(e,n,t)}))};a("next",0),a("throw",1),a("return",2)}},R(t,e,n,r)}function J(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,X(r.key),r)}}function X(t){var e=function(t,e){if("object"!=V(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=V(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==V(e)?e:e+""}var W=function(){return t=function t(e,n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.productManager=e,this.cart=n,this.cartUI=r,this.getMoneyFormat=o,this._loaderSVG='\n        <svg class="bf-loader-svg" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n        <circle cx="12" cy="12" r="10" stroke-opacity="0.2"/>\n        <path d="M22 12a10 10 0 0 1-10 10" />\n        <style>\n            .bf-loader-svg { animation: bf-rotate 1s linear infinite; vertical-align: middle;}\n            @keyframes bf-rotate { 100% { transform: rotate(360deg); } }\n        </style>\n        </svg>\n        ',this._checkSVG='\n        <svg class="bf-check-svg" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n        <path d="M20 6 9 17l-5-5"/>\n        </svg>\n        ',this.templates={}},e=[{key:"init",value:(r=K().m((function t(){return K().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,this.productManager.fetchAllProductsOnPage();case 1:this.renderProductDetails(),this.setupAddToCartButtons(),this.renderProductGalleries();case 2:return t.a(2)}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,o){var a=r.apply(t,e);function i(t){J(a,n,o,i,c,"next",t)}function c(t){J(a,n,o,i,c,"throw",t)}i(void 0)}))},function(){return o.apply(this,arguments)})},{key:"renderProductGalleries",value:function(){var t=this;document.querySelectorAll("[data-bf-product-gallery]").forEach((function(e){var n=e.closest("[data-bf-product-id]");if(n){var r=n.getAttribute("data-bf-product-id"),o=t.productManager.currentProducts[r];if(o&&o.images){var a=o.images.edges.map((function(t){return t.node})),i=0,c=e.querySelector("[data-bf-product-image-slider]"),u=e.querySelector("[data-bf-thumbnail-wrapper]");if(c||u){if(!t.templates.activeImage){var l=c.querySelector("[data-bf-product-image]");l&&(t.templates.activeImage=l.cloneNode(!0),t.templates.activeImage.style.display="none")}if(!t.templates.thumbnailImage){var s=u.querySelector("[data-bf-thumbnail-image]");s&&(t.templates.thumbnailImage=s.cloneNode(!0),t.templates.thumbnailImage.style.display="none")}var f=[],d=[];c&&(c.querySelectorAll("[data-bf-product-image]").forEach((function(e){t.templates.activeImage&&e!==t.templates.activeImage&&e.remove()})),a.forEach((function(e,n){var r=t.templates.activeImage?t.templates.activeImage.cloneNode(!0):document.createElement("img");r.setAttribute("data-bf-product-image",""),r.src=e.src,r.alt=e.altText||o.title||"",r.style.display=n===i?"":"none",r.classList.toggle("active",n===i),c.appendChild(r),f.push(r)}))),u&&(u.querySelectorAll("[data-bf-thumbnail-image]").forEach((function(e){t.templates.thumbnailImage&&e!==t.templates.thumbnailImage&&e.remove()})),a.forEach((function(e,n){var r=t.templates.thumbnailImage?t.templates.thumbnailImage.cloneNode(!0):document.createElement("img");r.setAttribute("data-bf-thumbnail-image",""),r.src=e.src,r.alt=e.altText||o.title||"",r.setAttribute("data-index",n),r.style.display="",r.classList.toggle("active",n===i),r.onclick=function(){m(n)},u.appendChild(r),d.push(r)})));var p=c.querySelector("[data-bf-image-slider-arrow-left]"),y=c.querySelector("[data-bf-image-slider-arrow-right]");p&&(p.onclick=function(t){t.preventDefault(),t.stopPropagation(),m((i-1+a.length)%a.length)}),y&&(y.onclick=function(t){t.preventDefault(),t.stopPropagation(),m((i+1)%a.length)})}}}function m(t){i=t,f.forEach((function(t,e){t.style.display=e===i?"":"none",t.classList.toggle("active",e===i)})),d.forEach((function(t,e){t.classList.toggle("active",e===i)}))}}))}},{key:"renderProductDetails",value:function(){var t=this;document.querySelectorAll("[data-bf-product-id]").forEach((function(e){var n,r=e.getAttribute("data-bf-product-id"),o=t.productManager.currentProducts[r];if(o){var a=e.querySelector("[data-bf-product-title]");a&&(a.textContent=o.title?o.title:"");var i=e.querySelector("[data-bf-product-description]");i&&(i.innerHTML=o.descriptionHtml?o.descriptionHtml:"");var c=null===(n=o.variants)||void 0===n||null===(n=n.edges)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.node;if(c){var u=e.querySelector("[data-bf-product-price]");u&&c.price&&(u.textContent=p.format(c.price.amount,c.price.currencyCode,t.getMoneyFormat()));var l=e.querySelector("[data-bf-product-compare-at-price]");l&&c.compareAtPrice&&c.compareAtPrice.amount?(l.textContent=p.format(c.compareAtPrice.amount,c.compareAtPrice.currencyCode,t.getMoneyFormat()),l.style.display=""):l&&(l.style.display="none")}}}))}},{key:"setupAddToCartButtons",value:function(){var t=this;document.querySelectorAll("[data-bf-add-to-cart]").forEach((function(e){var n=e.closest("[data-bf-product-id]");if(n){var r,o=n.getAttribute("data-bf-product-id"),a=t.productManager.currentProducts[o],i=null==a||null===(r=a.variants)||void 0===r||null===(r=r.edges)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.node;i&&i.availableForSale||(e.disabled=!0,e.innerHTML="Out of stock")}e.addEventListener("click",(function(n){n.preventDefault(),t.handleAddToCart(e)}))}))}},{key:"handleAddToCart",value:function(t){var e,n=this,r=t.closest("[data-bf-product-id]"),o=null==r?void 0:r.querySelector("[data-bf-qty]"),a=o?parseInt(o.value,10):1,i=this.productManager.currentProducts[r.dataset.bfProductId];if(i){var c=null==i||null===(e=i.variants)||void 0===e||null===(e=e.edges)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.node,u=null==c?void 0:c.id;if(!c||!c.availableForSale)return t.disabled=!0,void(t.innerHTML="Out of stock");u?(this.setButtonLoading(t,!0),this.cart.addToCart({variantId:u,quantity:a}).then((function(){t.innerHTML=n._checkSVG,setTimeout((function(){n.setButtonLoading(t,!1)}),1500),n.cartUI.openCartDrawer()})).catch((function(e){t.innerHTML="Error",setTimeout((function(){n.setButtonLoading(t,!1)}),1500),console.error("[Blink] Add to cart failed:",e)}))):console.error("[Blink] Missing variant id.")}else console.error("[Blink] Product not found in currentProducts:",r.dataset.bfProductId)}},{key:"setButtonLoading",value:function(t,e){e?(t.disabled=!0,t.classList.add("bf-loading"),t.dataset.originalText||(t.dataset.originalText=t.innerHTML),t.innerHTML=this._loaderSVG):(t.disabled=!1,t.classList.remove("bf-loading"),t.dataset.originalText&&(t.innerHTML=t.dataset.originalText,delete t.dataset.originalText))}}],e&&z(t.prototype,e),n&&z(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function Z(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return tt(l,"_invoke",function(n,r,o){var a,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,u=t,d.n=n,i}};function p(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,a=s[e],p=d.p,y=a[2];n>3?(o=y===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<y&&(o=n<3||a[0]>r||r>y)&&(a[4]=n,a[5]=r,d.n=y,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,y),c=s,u=y;(e=c<2?t:u)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(e){a=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,a),!0),l}var i={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(tt(e={},r,(function(){return this})),e),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,tt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,tt(f,"constructor",l),tt(l,"constructor",u),u.displayName="GeneratorFunction",tt(l,o,"GeneratorFunction"),tt(f),tt(f,o,"Generator"),tt(f,r,(function(){return this})),tt(f,"toString",(function(){return"[object Generator]"})),(Z=function(){return{w:a,m:d}})()}function tt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}tt=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){tt(t,e,(function(t){return this._invoke(e,n,t)}))};a("next",0),a("throw",1),a("return",2)}},tt(t,e,n,r)}function et(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,rt(r.key),r)}}function rt(t){var e=function(t,e){if("object"!=Y(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Y(e)?e:e+""}var ot=function(){return t=function t(){var e,n,r=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),t._instance)return t._instance;t._instance=this;var a=(null===(e=o.shopify)||void 0===e?void 0:e.token)||this._getTokenFromDOM(),c=(null===(n=o.shopify)||void 0===n?void 0:n.storeDomain)||this._getStoreDomainFromDOM();a&&c?(this.shopifyClient=new i({token:a,storeDomain:c}),this.productManager=new T(this.shopifyClient),this.cart=new L(this.shopifyClient,this.productManager),this.cartUI=new H(this.cart),this.productUI=new W(this.productManager,this.cart,this.cartUI,(function(){return r.cart._moneyFormat})),this.store={shopName:null,moneyFormat:null},this._init()):console.error("[Blink] Shopify Token or Store Domain not provided or found in DOM.")},e=[{key:"_init",value:(r=Z().m((function t(){var e,n,r,o;return Z().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,this.cart.init();case 1:return t.n=2,this.cartUI.init();case 2:return t.n=3,this.productUI.init();case 3:if(e=d.get("blink_shop_info"))try{n=e,this.store.shopName=n.shopName||null,this.store.moneyFormat=n.moneyFormat||null}catch(t){console.warn("[Blink] Invalid cached shop info, fetching fresh.")}if(this.store.shopName&&this.store.moneyFormat){t.n=5;break}return t.n=4,this.shopifyClient.executeQuery("\n            {\n                shop {\n                    name\n                    moneyFormat\n                }\n            }\n            ");case 4:null!=(o=t.v)&&null!==(r=o.data)&&void 0!==r&&r.shop&&(this.store.shopName=o.data.shop.name,this.store.moneyFormat=o.data.shop.moneyFormat,d.set("blink_shop_info",{shopName:this.store.shopName,moneyFormat:this.store.moneyFormat},36e5));case 5:return t.a(2)}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,o){var a=r.apply(t,e);function i(t){et(a,n,o,i,c,"next",t)}function c(t){et(a,n,o,i,c,"throw",t)}i(void 0)}))},function(){return o.apply(this,arguments)})},{key:"_getTokenFromDOM",value:function(){var t,e=document.querySelector('script[data-name="blink-main-script"]');return null!==(t=null==e?void 0:e.getAttribute("data-store-token"))&&void 0!==t?t:null}},{key:"_getStoreDomainFromDOM",value:function(){var t,e=document.querySelector('script[data-name="blink-main-script"]');return null!==(t=null==e?void 0:e.getAttribute("data-store-domain"))&&void 0!==t?t:null}}],e&&nt(t.prototype,e),n&&nt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();document.addEventListener("DOMContentLoaded",(function(){window.Blink=new ot}))})();