/*! For license information please see bundle.min.js.LICENSE.txt */
(()=>{"use strict";function t(n){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(n)}function n(){var t,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function c(n,o,i,a){var c=o&&o.prototype instanceof l?o:l,s=Object.create(c.prototype);return e(s,"_invoke",function(n,e,o){var i,a,c,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,a=0,c=t,d.n=e,u}};function y(n,e){for(a=n,c=e,r=0;!f&&l&&!o&&r<s.length;r++){var o,i=s[r],y=d.p,p=i[2];n>3?(o=p===e)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=n<2&&y<i[1])?(a=0,d.v=e,d.n=i[1]):y<p&&(o=n<3||i[0]>e||e>p)&&(i[4]=n,i[5]=e,d.n=p,a=0))}if(o||n>1)return u;throw f=!0,e}return function(o,s,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&y(s,p),a=s,c=p;(r=a<2?t:c)||!f;){i||(a?a<3?(a>1&&(d.n=-1),y(a,c)):d.n=c:d.v=c);try{if(l=2,i){if(a||(o="next"),r=i[o]){if(!(r=r.call(i,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,a<2&&(a=0)}else 1===a&&(r=i.return)&&r.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((r=(f=d.n<0)?c:n.call(e,d))!==u)break}catch(n){i=t,a=1,c=n}finally{l=1}}return{value:r,done:f}}}(n,i,a),!0),s}var u={};function l(){}function s(){}function f(){}r=Object.getPrototypeOf;var d=[][i]?r(r([][i]())):(e(r={},i,(function(){return this})),r),y=f.prototype=l.prototype=Object.create(d);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t}return s.prototype=f,e(y,"constructor",f),e(f,"constructor",s),s.displayName="GeneratorFunction",e(f,a,"GeneratorFunction"),e(y),e(y,a,"Generator"),e(y,i,(function(){return this})),e(y,"toString",(function(){return"[object Generator]"})),(n=function(){return{w:c,m:p}})()}function e(t,n,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}e=function(t,n,r,o){if(n)i?i(t,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[n]=r;else{var a=function(n,r){e(t,n,(function(t){return this._invoke(n,r,t)}))};a("next",0),a("throw",1),a("return",2)}},e(t,n,r,o)}function r(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function o(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i(r.key),r)}}function i(n){var e=function(n,e){if("object"!=t(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var o=r.call(n,e||"default");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==t(e)?e:e+""}var a=function(){return t=function t(n){var e=n.token,r=n.storeDomain;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.token=e,this.storeDomain=r},e=[{key:"executeQuery",value:(a=n().m((function t(e){var r,o,i,a,c,u=arguments;return n().w((function(t){for(;;)switch(t.n){case 0:if(r=u.length>1&&void 0!==u[1]?u[1]:{},this.token&&this.storeDomain){t.n=1;break}return console.error("[Blink] Shopify instance is not initialized."),t.a(2);case 1:return o="https://".concat(this.storeDomain,"/api/2025-04/graphql.json"),t.p=2,t.n=3,fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":this.token},body:JSON.stringify({query:e,variables:r})});case 3:if((i=t.v).ok){t.n=5;break}return t.n=4,i.json();case 4:throw a=t.v,console.error("Shopify API Error:",a),new Error("Shopify GraphQL error: ".concat(i.status));case 5:return t.n=6,i.json();case 6:return t.a(2,t.v);case 7:throw t.p=7,c=t.v,console.error("Shopify API Error:",c.message),c;case 8:return t.a(2)}}),t,this,[[2,7]])})),c=function(){var t=this,n=arguments;return new Promise((function(e,o){var i=a.apply(t,n);function c(t){r(i,e,o,c,u,"next",t)}function u(t){r(i,e,o,c,u,"throw",t)}c(void 0)}))},function(t){return c.apply(this,arguments)})}],e&&o(t.prototype,e),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,i,a,c}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function u(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function l(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f(r.key),r)}}function s(t,n,e){return n&&l(t.prototype,n),e&&l(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function f(t){var n=function(t,n){if("object"!=c(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==c(n)?n:n+""}var d=function(){return s((function t(){u(this,t)}),null,[{key:"set",value:function(t,n,e){var r=Date.now()+e;localStorage.setItem(t,JSON.stringify({value:n,expires:r}))}},{key:"get",value:function(t){var n=localStorage.getItem(t);if(!n)return null;try{var e=JSON.parse(n),r=e.value,o=e.expires;return Date.now()>o?(localStorage.removeItem(t),null):r}catch(n){return localStorage.removeItem(t),null}}},{key:"remove",value:function(t){localStorage.removeItem(t)}}])}(),y=function(){return s((function t(){u(this,t)}),null,[{key:"format",value:function(t,n){var e=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"{{amount}}{{currency_code}}")||"${{amount}}";return e=(e=e.replace("{{amount}}",parseFloat(t).toFixed(2))).replace("{{currency_code}}",n||"")}}])}();function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function h(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function v(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?h(Object(e),!0).forEach((function(n){m(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):h(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function m(t,n,e){return(n=O(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function b(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return g(l,"_invoke",function(e,r,o){var i,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,c=0,u=t,d.n=e,a}};function y(e,r){for(c=e,u=r,n=0;!f&&l&&!o&&n<s.length;n++){var o,i=s[n],y=d.p,p=i[2];e>3?(o=p===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,d.v=r,d.n=i[1]):y<p&&(o=e<3||i[0]>r||r>p)&&(i[4]=e,i[5]=r,d.n=p,c=0))}if(o||e>1)return a;throw f=!0,r}return function(o,s,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&y(s,p),c=s,u=p;(n=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(d.n=-1),y(c,u)):d.n=u:d.v=u);try{if(l=2,i){if(c||(o="next"),n=i[o]){if(!(n=n.call(i,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=i.return)&&n.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((n=(f=d.n<0)?u:e.call(r,d))!==a)break}catch(n){i=t,c=1,u=n}finally{l=1}}return{value:n,done:f}}}(e,o,i),!0),l}var a={};function c(){}function u(){}function l(){}n=Object.getPrototypeOf;var s=[][r]?n(n([][r]())):(g(n={},r,(function(){return this})),n),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,g(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,g(f,"constructor",l),g(l,"constructor",u),u.displayName="GeneratorFunction",g(l,o,"GeneratorFunction"),g(f),g(f,o,"Generator"),g(f,r,(function(){return this})),g(f,"toString",(function(){return"[object Generator]"})),(b=function(){return{w:i,m:d}})()}function g(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}g=function(t,n,e,r){if(n)o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e;else{var i=function(n,e){g(t,n,(function(t){return this._invoke(n,e,t)}))};i("next",0),i("throw",1),i("return",2)}},g(t,n,e,r)}function w(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=k(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(c)throw i}}}}function S(t){return function(t){if(Array.isArray(t))return C(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||k(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t,n){if(t){if("string"==typeof t)return C(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?C(t,n):void 0}}function C(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function P(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function _(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){P(i,r,o,a,c,"next",t)}function c(t){P(i,r,o,a,c,"throw",t)}a(void 0)}))}}function j(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,O(r.key),r)}}function O(t){var n=function(t,n){if("object"!=p(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==p(n)?n:n+""}var T=function(){return t=function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.shopifyClient=n,this.currentProducts={},this._productCacheKey="blink_products",this._productCacheTTL=6e5},n=[{key:"fetchAllProductsOnPage",value:(o=_(b().m((function t(){var n,e,r,o,i,a,c,u=this,l=arguments;return b().w((function(t){for(;;)switch(t.n){case 0:n=(l.length>0&&void 0!==l[0]?l[0]:null)||Array.from(document.querySelectorAll("[data-bf-product-id]")).map((function(t){return t.getAttribute("data-bf-product-id")})).filter(Boolean),e=S(new Set(n)),r=d.get(this._productCacheKey)||{},o=e.filter((function(t){return!r[t]})),i=w(e);try{for(i.s();!(a=i.n()).done;)c=a.value,r[c]&&(this.currentProducts[c]=r[c])}catch(t){i.e(t)}finally{i.f()}return t.n=1,Promise.all(o.map(function(){var t=_(b().m((function t(n){var e,r;return b().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,u.fetchAndStoreProduct(n);case 1:(e=t.v)&&(u.currentProducts[n]=e),t.n=3;break;case 2:t.p=2,r=t.v,console.error("[Blink] Failed to fetch product ".concat(n,":"),r);case 3:return t.a(2)}}),t,null,[[0,2]])})));return function(n){return t.apply(this,arguments)}}()));case 1:d.set(this._productCacheKey,v(v({},r),this.currentProducts),this._productCacheTTL);case 2:return t.a(2)}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"fetchAndStoreProduct",value:(r=_(b().m((function t(n){var e;return b().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,this.shopifyClient.executeQuery("\n        query Products($id: ID!) @inContext(language: EN) {\n          node(id: $id) {\n            ... on Product {\n              id\n              title\n              handle\n              description\n              descriptionHtml\n              priceRange {\n                minVariantPrice { amount currencyCode }\n                maxVariantPrice { amount currencyCode }\n              }\n              compareAtPriceRange {\n                minVariantPrice { amount currencyCode }\n                maxVariantPrice { amount currencyCode }\n              }\n              options {\n                name\n                optionValues {\n                  id\n                  name\n                  swatch {\n                    color\n                    image {\n                      id\n                      alt\n                      previewImage {\n                        altText\n                        url\n                      }\n                    }\n                  }\n                }\n              }\n              images(first: 100) {\n                edges {\n                  node {\n                    src\n                    altText\n                    id\n                    width\n                    height\n                  }\n                }\n              }\n              collections(first: 250) {\n                edges {\n                  node {\n                    id\n                    title\n                    metafields(identifiers: []) {\n                      id\n                      namespace\n                      key\n                      value\n                      reference {\n                        __typename\n                        ... on MediaImage {\n                          alt\n                          image { url }\n                        }\n                      }\n                      type\n                      description\n                    }\n                    handle\n                    description\n                    descriptionHtml\n                    image { src }\n                  }\n                }\n              }\n              vendor\n              productType\n              tags\n              requiresSellingPlan\n              variants(first: 100) {\n                edges {\n                  node {\n                    id\n                    product { id title vendor }\n                    title\n                    sku\n                    barcode\n                    price { amount currencyCode }\n                    unitPrice { amount currencyCode }\n                    compareAtPrice { amount currencyCode }\n                    image { src altText id width height }\n                    selectedOptions { name value }\n                    availableForSale\n                    currentlyNotInStock\n                    quantityAvailable\n                    product { id title vendor }\n                    metafields(identifiers: []) {\n                      id\n                      namespace\n                      key\n                      value\n                      reference {\n                        __typename\n                        ... on MediaImage {\n                          alt\n                          image { url }\n                        }\n                      }\n                      type\n                      description\n                    }\n                    weight\n                    weightUnit\n                    sellingPlanAllocations(first: 10) {\n                      edges {\n                        node {\n                          sellingPlan {\n                            id\n                            name\n                            description\n                            checkoutCharge { type value }\n                            recurringDeliveries\n                            options { name value }\n                          }\n                          priceAdjustments {\n                            price { amount currencyCode }\n                            compareAtPrice { amount currencyCode }\n                            perDeliveryPrice { amount currencyCode }\n                            unitPrice { amount currencyCode }\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n              sellingPlanGroups(first: 10) {\n                edges {\n                  node {\n                    appName\n                    name\n                    sellingPlans(first: 10) {\n                      edges {\n                        node {\n                          id\n                          name\n                          description\n                          recurringDeliveries\n                          options { name value }\n                          priceAdjustments {\n                            orderCount\n                            adjustmentValue {\n                              __typename\n                              ... on SellingPlanPercentagePriceAdjustment {\n                                adjustmentPercentage\n                              }\n                              ... on SellingPlanFixedAmountPriceAdjustment {\n                                adjustmentAmount { amount currencyCode }\n                              }\n                              ... on SellingPlanFixedPriceAdjustment {\n                                price { amount currencyCode }\n                              }\n                            }\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n        ",{id:n});case 1:if(!((e=t.v)&&e.data&&e.data.node)){t.n=2;break}return t.a(2,e.data.node);case 2:return t.a(2,null)}}),t,this)}))),function(t){return r.apply(this,arguments)})}],n&&j(t.prototype,n),e&&j(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,r,o}();function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function I(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return E(l,"_invoke",function(e,r,o){var i,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,c=0,u=t,d.n=e,a}};function y(e,r){for(c=e,u=r,n=0;!f&&l&&!o&&n<s.length;n++){var o,i=s[n],y=d.p,p=i[2];e>3?(o=p===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,d.v=r,d.n=i[1]):y<p&&(o=e<3||i[0]>r||r>p)&&(i[4]=e,i[5]=r,d.n=p,c=0))}if(o||e>1)return a;throw f=!0,r}return function(o,s,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&y(s,p),c=s,u=p;(n=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(d.n=-1),y(c,u)):d.n=u:d.v=u);try{if(l=2,i){if(c||(o="next"),n=i[o]){if(!(n=n.call(i,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=i.return)&&n.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((n=(f=d.n<0)?u:e.call(r,d))!==a)break}catch(n){i=t,c=1,u=n}finally{l=1}}return{value:n,done:f}}}(e,o,i),!0),l}var a={};function c(){}function u(){}function l(){}n=Object.getPrototypeOf;var s=[][r]?n(n([][r]())):(E(n={},r,(function(){return this})),n),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,E(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,E(f,"constructor",l),E(l,"constructor",u),u.displayName="GeneratorFunction",E(l,o,"GeneratorFunction"),E(f),E(f,o,"Generator"),E(f,r,(function(){return this})),E(f,"toString",(function(){return"[object Generator]"})),(I=function(){return{w:i,m:d}})()}function E(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}E=function(t,n,e,r){if(n)o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e;else{var i=function(n,e){E(t,n,(function(t){return this._invoke(n,e,t)}))};i("next",0),i("throw",1),i("return",2)}},E(t,n,e,r)}function x(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function F(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){x(i,r,o,a,c,"next",t)}function c(t){x(i,r,o,a,c,"throw",t)}a(void 0)}))}}function q(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,D(r.key),r)}}function D(t){var n=function(t,n){if("object"!=A(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=A(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==A(n)?n:n+""}var G=function(){return t=function t(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"blink_cart";!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.shopifyClient=n,this.productManager=e,this._cartStorageKey=r,this._cart=null,this.cartId=null,this._templates={},this._moneyFormat="{{amount}}{{currency_code}}",this._cartCacheTTL=144e5,this.onCartChange=null},n=[{key:"init",value:(f=F(I().m((function t(){var n;return I().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,this._fetchShopMoneyFormat();case 1:t.p=1,(n=d.get(this._cartStorageKey))&&(this._cart=n,this.cartId=this._cart.id,console.info("[Blink] Cart loaded from localStorage:",this._cart)),t.n=3;break;case 2:return t.p=2,t.v,console.warn("[Blink] Invalid or expired cart, resetting..."),t.n=3,this.clearCart();case 3:return t.a(2)}}),t,this,[[1,2]])}))),function(){return f.apply(this,arguments)})},{key:"_fetchShopMoneyFormat",value:(s=F(I().m((function t(){var n,e,r,o,i;return I().w((function(t){for(;;)switch(t.n){case 0:if(!(r=d.get("blink_shop_info"))){t.n=3;break}return t.p=1,o=r,this._moneyFormat=o.moneyFormat||"{{amount}}{{currency_code}}",t.a(2);case 2:t.p=2,t.v;case 3:return t.n=4,this.shopifyClient.executeQuery("\n        {\n            shop {\n                name\n                moneyFormat\n            }\n        }\n        ");case 4:i=t.v,this._moneyFormat=(null==i||null===(n=i.data)||void 0===n||null===(n=n.shop)||void 0===n?void 0:n.moneyFormat)||"{{amount}}{{currency_code}}",null!=i&&null!==(e=i.data)&&void 0!==e&&e.shop&&d.set("blink_shop_info",{shopName:i.data.shop.name,moneyFormat:i.data.shop.moneyFormat},36e5);case 5:return t.a(2)}}),t,this,[[1,2]])}))),function(){return s.apply(this,arguments)})},{key:"addToCart",value:(l=F(I().m((function t(n){var e,r,o,i;return I().w((function(t){for(;;)switch(t.n){case 0:if(e=n.variantId,r=n.quantity,o=void 0===r?1:r,this._cart){t.n=3;break}return t.n=1,this._createCart(e,o);case 1:return i=t.v,this.cartId=i.id,t.n=2,this.refreshCart();case 2:case 5:return t.a(2,this._cart);case 3:return t.n=4,this._addToExistingCart(e,o);case 4:return t.n=5,this.refreshCart();case 6:return t.a(2)}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"_createCart",value:(u=F(I().m((function t(n,e){var r,o;return I().w((function(t){for(;;)switch(t.n){case 0:return r={input:{lines:[{quantity:e,merchandiseId:n}]}},t.n=1,this.shopifyClient.executeQuery("\n            mutation cartCreate($input: CartInput!) {\n                cartCreate(input: $input) {\n                 cart {\n                    id\n                }\n                userErrors {\n                    field\n                    message\n                }\n                }\n            }\n            ",r);case 1:if(!((o=t.v).userErrors&&o.userErrors.length>0)){t.n=2;break}throw console.error("[Blink] Shopify user errors:",o.userErrors),new Error("Failed to create cart: "+o.userErrors[0].message);case 2:return t.a(2,o.data.cartCreate.cart)}}),t,this)}))),function(t,n){return u.apply(this,arguments)})},{key:"_addToExistingCart",value:(c=F(I().m((function t(n,e){var r,o;return I().w((function(t){for(;;)switch(t.n){case 0:return r={cartId:this.cartId,lines:[{quantity:e,merchandiseId:n}]},t.n=1,this.shopifyClient.executeQuery("\n            mutation cartLinesAdd($cartId: ID!, $lines: [CartLineInput!]!) {\n                cartLinesAdd(cartId: $cartId, lines: $lines) {\n                cart {\n                    id\n                }\n                userErrors {\n                    field\n                    message\n                }\n                }\n            }\n            ",r);case 1:if(!((o=t.v).data.cartLinesAdd.userErrors&&o.data.cartLinesAdd.userErrors.length>0)){t.n=2;break}throw console.error("[Blink] Shopify user errors:",o.data.cartLinesAdd.userErrors),new Error("Failed to add to cart: "+o.data.cartLinesAdd.userErrors[0].message);case 2:return t.a(2,o.data.cartLinesAdd.cart)}}),t,this)}))),function(t,n){return c.apply(this,arguments)})},{key:"fetchCart",value:(a=F(I().m((function t(n){var e,r;return I().w((function(t){for(;;)switch(t.n){case 0:return e={cartId:n},t.n=1,this.shopifyClient.executeQuery("\n            query getCart($cartId: ID!) {\n            cart(id: $cartId) {\n                id\n                checkoutUrl\n                createdAt\n                updatedAt\n                totalQuantity\n\n                lines(first: 50) {\n                edges {\n                    node {\n                    id\n                    quantity\n                    attributes {\n                        key\n                        value\n                    }\n                    cost {\n                        amountPerQuantity {\n                        amount\n                        currencyCode\n                        }\n                        totalAmount {\n                        amount\n                        currencyCode\n                        }\n                    }\n                    merchandise {\n                        ... on ProductVariant {\n                        id\n                        title\n                        sku\n                        availableForSale\n                        quantityAvailable\n                        image {\n                            url\n                            altText\n                        }\n                        price {\n                            amount\n                            currencyCode\n                        }\n                        product {\n                            id\n                            title\n                            handle\n                            vendor\n                            featuredImage {\n                            url\n                            altText\n                            }\n                        }\n                        }\n                    }\n                    sellingPlanAllocation {\n                        sellingPlan {\n                        id\n                        name\n                        options {\n                            name\n                            value\n                        }\n                        }\n                    }\n                    }\n                }\n                }\n\n                estimatedCost {\n                subtotalAmount {\n                    amount\n                    currencyCode\n                }\n                totalAmount {\n                    amount\n                    currencyCode\n                }\n                totalTaxAmount {\n                    amount\n                    currencyCode\n                }\n                }\n            }\n            }\n        ",e);case 1:if(!(r=t.v).errors){t.n=2;break}return console.error("[Blink] Error fetching cart:",r.errors),t.a(2,null);case 2:return t.a(2,r.data.cart)}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"clearCart",value:(i=F(I().m((function t(){var n,e;return I().w((function(t){for(;;)switch(t.n){case 0:if(!(this._cart&&this._cart.lines&&this._cart.lines.edges.length>0)){t.n=3;break}if(!((n=this._cart.lines.edges.map((function(t){return t.node.id}))).length>0)){t.n=1;break}return e={cartId:this.cartId,lineIds:n},t.n=1,this.shopifyClient.executeQuery("\n                mutation cartLinesRemove($cartId: ID!, $lineIds: [ID!]!) {\n                    cartLinesRemove(cartId: $cartId, lineIds: $lineIds) {\n                        cart { id }\n                        userErrors { field message }\n                    }\n                }\n            ",e);case 1:return t.n=2,this.refreshCart();case 2:t.n=4;break;case 3:return t.n=4,this.refreshCart();case 4:return t.a(2)}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"removeLineItem",value:(o=F(I().m((function t(n){var e;return I().w((function(t){for(;;)switch(t.n){case 0:return e={cartId:this.cartId,lineIds:[n]},t.n=1,this.shopifyClient.executeQuery("\n        mutation cartLinesRemove($cartId: ID!, $lineIds: [ID!]!) {\n            cartLinesRemove(cartId: $cartId, lineIds: $lineIds) {\n                cart { id }\n                userErrors { field message }\n            }\n        }\n    ",e);case 1:return t.a(2)}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"refreshCart",value:(r=F(I().m((function t(){return I().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,this.fetchCart(this.cartId);case 1:this._cart=t.v,d.set(this._cartStorageKey,this._cart,this._cartCacheTTL),this.cartId=this._cart.id,console.info("[Blink] Cart refreshed:",this._cart),"function"==typeof this.onCartChange&&this.onCartChange(this._cart);case 2:return t.a(2)}}),t,this)}))),function(){return r.apply(this,arguments)})}],n&&q(t.prototype,n),e&&q(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,r,o,i,a,c,u,l,s,f}();function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function M(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return B(l,"_invoke",function(e,r,o){var i,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,c=0,u=t,d.n=e,a}};function y(e,r){for(c=e,u=r,n=0;!f&&l&&!o&&n<s.length;n++){var o,i=s[n],y=d.p,p=i[2];e>3?(o=p===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,d.v=r,d.n=i[1]):y<p&&(o=e<3||i[0]>r||r>p)&&(i[4]=e,i[5]=r,d.n=p,c=0))}if(o||e>1)return a;throw f=!0,r}return function(o,s,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&y(s,p),c=s,u=p;(n=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(d.n=-1),y(c,u)):d.n=u:d.v=u);try{if(l=2,i){if(c||(o="next"),n=i[o]){if(!(n=n.call(i,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=i.return)&&n.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((n=(f=d.n<0)?u:e.call(r,d))!==a)break}catch(n){i=t,c=1,u=n}finally{l=1}}return{value:n,done:f}}}(e,o,i),!0),l}var a={};function c(){}function u(){}function l(){}n=Object.getPrototypeOf;var s=[][r]?n(n([][r]())):(B(n={},r,(function(){return this})),n),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,B(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,B(f,"constructor",l),B(l,"constructor",u),u.displayName="GeneratorFunction",B(l,o,"GeneratorFunction"),B(f),B(f,o,"Generator"),B(f,r,(function(){return this})),B(f,"toString",(function(){return"[object Generator]"})),(M=function(){return{w:i,m:d}})()}function B(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}B=function(t,n,e,r){if(n)o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e;else{var i=function(n,e){B(t,n,(function(t){return this._invoke(n,e,t)}))};i("next",0),i("throw",1),i("return",2)}},B(t,n,e,r)}function N(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function $(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){N(i,r,o,a,c,"next",t)}function c(t){N(i,r,o,a,c,"throw",t)}a(void 0)}))}}function U(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Q(r.key),r)}}function Q(t){var n=function(t,n){if("object"!=L(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==L(n)?n:n+""}var V=function(){return t=function t(n){var e=this;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.cart=n,this._templates={},this.cart.onCartChange=function(){return e.renderCart()}},n=[{key:"init",value:(r=$(M().m((function t(){return M().w((function(t){for(;;)switch(t.n){case 0:this.closeCartDrawer(),this._setupCartTriggerButtons(),this._setupCheckoutButtons(),this._setupClearCartButtons(),this.renderCart();case 1:return t.a(2)}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"renderCart",value:function(){var t=this,n=this.cart._cart;document.querySelectorAll("[data-bf-cart]").forEach((function(e){var r=e.querySelector("[data-bf-cart-items-count]"),o=0,i=e.querySelector("[data-bf-line-items]");if(i){var a=t._templates.cartTemplate;if(!a){if(!(a=i.querySelector("[data-bf-line-item]")))return;t._templates.cartTemplate=a.cloneNode(!0)}a.style.display="none";var c=e.querySelector("[data-bf-empty-cart-message]");c&&(c.style.display="none"),i.querySelectorAll("[data-bf-line-item]").forEach((function(t){t!==a&&t.remove()}));var u=e.querySelector("[data-bf-cart-subtotal]"),l=e.querySelector("[data-bf-cart-total]");if(t.updateCartTotals(u,l,n),!n||!n.lines||!n.lines.edges.length)return a.style.display="none",void(c&&(c.style.display=""));n.lines.edges.forEach((function(n){o+=n.node.quantity;var e=n.node,r=a.cloneNode(!0);i.appendChild(r),r.style.display="";var c,u,l=r.querySelector("[data-bf-line-image]");l&&(l.src=null===(c=e.merchandise.image)||void 0===c?void 0:c.url,l.alt=(null===(u=e.merchandise.image)||void 0===u?void 0:u.altText)||"");var s=r.querySelector("[data-bf-line-title]");s&&(s.textContent=e.merchandise.product.title);var f=r.querySelector("[data-bf-line-selected-option]");f&&(f.textContent=e.merchandise.title);var d=r.querySelector("[data-bf-line-qty]");d&&(d.textContent=e.quantity);var p=r.querySelector("[data-bf-line-amount-per-qty]");p&&e.cost&&e.cost.amountPerQuantity&&(p.textContent=y.format(e.cost.amountPerQuantity.amount,e.cost.amountPerQuantity.currencyCode,t.cart._moneyFormat));var h=r.querySelector("[data-bf-line-total-amount]");h&&e.cost&&e.cost.totalAmount&&(h.textContent=y.format(e.cost.totalAmount.amount,e.cost.totalAmount.currencyCode,t.cart._moneyFormat));var v=r.querySelector("[data-bf-remove-line-item]");v&&(v.onclick=function(){var n=$(M().m((function n(r){return M().w((function(n){for(;;)switch(n.n){case 0:return r.preventDefault(),n.n=1,t.cart.removeLineItem(e.id);case 1:return n.n=2,t.cart.refreshCart();case 2:t.renderCart();case 3:return n.a(2)}}),n)})));return function(t){return n.apply(this,arguments)}}())})),r&&(r.textContent="(".concat(o,")"),r.style.display=o>0?"":"none"),n.lines.edges.length>1&&(a.style.display="")}}))}},{key:"updateCartTotals",value:function(t,n,e){var r,o,i,a;if(!e||null==e||!e.estimatedCost)return t&&(t.textContent=y.format(0,"USD")),void(n&&(n.textContent=y.format(0,"USD")));var c=(null==e||null===(r=e.estimatedCost)||void 0===r||null===(r=r.subtotalAmount)||void 0===r?void 0:r.amount)||0,u=(null==e||null===(o=e.estimatedCost)||void 0===o||null===(o=o.subtotalAmount)||void 0===o?void 0:o.currencyCode)||"USD",l=(null==e||null===(i=e.estimatedCost)||void 0===i||null===(i=i.totalAmount)||void 0===i?void 0:i.amount)||0,s=(null==e||null===(a=e.estimatedCost)||void 0===a||null===(a=a.totalAmount)||void 0===a?void 0:a.currencyCode)||"USD";t&&(t.textContent=y.format(c,u,this.cart._moneyFormat)),n&&(n.textContent=y.format(l,s,this.cart._moneyFormat))}},{key:"_setupCartTriggerButtons",value:function(){var t=this,n=document.querySelectorAll("[data-bf-cart-drawer-open]"),e=document.querySelectorAll("[data-bf-cart-drawer-close]");n.forEach((function(n){n.addEventListener("click",(function(){return t.openCartDrawer()}))})),e.forEach((function(n){n.addEventListener("click",(function(){return t.closeCartDrawer()}))}))}},{key:"closeCartDrawer",value:function(t){var n=t||document.querySelector("[data-bf-cart-drawer]");n&&(n.classList.remove("open"),n.setAttribute("aria-hidden","true"))}},{key:"openCartDrawer",value:function(t){var n=t||document.querySelector("[data-bf-cart-drawer]");n&&(n.classList.add("open"),n.setAttribute("aria-hidden","false"))}},{key:"_setupCheckoutButtons",value:function(){var t=this;document.querySelectorAll("[data-bf-checkout]").forEach((function(n){n.addEventListener("click",(function(n){n.preventDefault(),t.cart._cart&&t.cart._cart.checkoutUrl?window.location.href=t.cart._cart.checkoutUrl:console.warn("[Blink] No checkoutUrl available on cart.")}))}))}},{key:"_setupClearCartButtons",value:function(){var t=this;document.querySelectorAll("[data-bf-clear-cart]").forEach((function(n){n.addEventListener("click",function(){var n=$(M().m((function n(e){return M().w((function(n){for(;;)switch(n.n){case 0:return e.preventDefault(),n.n=1,t.cart.clearCart();case 1:return n.n=2,t.cart.refreshCart();case 2:t.renderCart();case 3:return n.a(2)}}),n)})));return function(t){return n.apply(this,arguments)}}())}))}}],n&&U(t.prototype,n),e&&U(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,r}();function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function K(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return R(l,"_invoke",function(e,r,o){var i,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,c=0,u=t,d.n=e,a}};function y(e,r){for(c=e,u=r,n=0;!f&&l&&!o&&n<s.length;n++){var o,i=s[n],y=d.p,p=i[2];e>3?(o=p===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,d.v=r,d.n=i[1]):y<p&&(o=e<3||i[0]>r||r>p)&&(i[4]=e,i[5]=r,d.n=p,c=0))}if(o||e>1)return a;throw f=!0,r}return function(o,s,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&y(s,p),c=s,u=p;(n=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(d.n=-1),y(c,u)):d.n=u:d.v=u);try{if(l=2,i){if(c||(o="next"),n=i[o]){if(!(n=n.call(i,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=i.return)&&n.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((n=(f=d.n<0)?u:e.call(r,d))!==a)break}catch(n){i=t,c=1,u=n}finally{l=1}}return{value:n,done:f}}}(e,o,i),!0),l}var a={};function c(){}function u(){}function l(){}n=Object.getPrototypeOf;var s=[][r]?n(n([][r]())):(R(n={},r,(function(){return this})),n),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,R(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,R(f,"constructor",l),R(l,"constructor",u),u.displayName="GeneratorFunction",R(l,o,"GeneratorFunction"),R(f),R(f,o,"Generator"),R(f,r,(function(){return this})),R(f,"toString",(function(){return"[object Generator]"})),(K=function(){return{w:i,m:d}})()}function R(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}R=function(t,n,e,r){if(n)o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e;else{var i=function(n,e){R(t,n,(function(t){return this._invoke(n,e,t)}))};i("next",0),i("throw",1),i("return",2)}},R(t,n,e,r)}function J(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function z(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,X(r.key),r)}}function X(t){var n=function(t,n){if("object"!=H(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=H(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==H(n)?n:n+""}var W=function(){return t=function t(n,e,r,o){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.productManager=n,this.cart=e,this.cartUI=r,this.getMoneyFormat=o,this._loaderSVG='\n        <svg class="bf-loader-svg" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n        <circle cx="12" cy="12" r="10" stroke-opacity="0.2"/>\n        <path d="M22 12a10 10 0 0 1-10 10" />\n        <style>\n            .bf-loader-svg { animation: bf-rotate 1s linear infinite; vertical-align: middle;}\n            @keyframes bf-rotate { 100% { transform: rotate(360deg); } }\n        </style>\n        </svg>\n        ',this._checkSVG='\n        <svg class="bf-check-svg" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n        <path d="M20 6 9 17l-5-5"/>\n        </svg>\n        '},n=[{key:"init",value:(r=K().m((function t(){return K().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,this.productManager.fetchAllProductsOnPage();case 1:this.renderProductPrices(),this.setupAddToCartButtons();case 2:return t.a(2)}}),t,this)})),o=function(){var t=this,n=arguments;return new Promise((function(e,o){var i=r.apply(t,n);function a(t){J(i,e,o,a,c,"next",t)}function c(t){J(i,e,o,a,c,"throw",t)}a(void 0)}))},function(){return o.apply(this,arguments)})},{key:"renderProductPrices",value:function(){var t=this;document.querySelectorAll("[data-bf-product-id]").forEach((function(n){var e,r=n.getAttribute("data-bf-product-id"),o=t.productManager.currentProducts[r];if(o){var i=null===(e=o.variants)||void 0===e||null===(e=e.edges)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.node;if(i){var a=n.querySelector("[data-bf-product-price]");a&&i.price&&(a.textContent=y.format(i.price.amount,i.price.currencyCode,t.getMoneyFormat()));var c=n.querySelector("[data-bf-product-compare-at-price]");c&&i.compareAtPrice&&i.compareAtPrice.amount?(c.textContent=y.format(i.compareAtPrice.amount,i.compareAtPrice.currencyCode,t.getMoneyFormat()),c.style.display=""):c&&(c.style.display="none")}}}))}},{key:"setupAddToCartButtons",value:function(){var t=this;document.querySelectorAll("[data-bf-add-to-cart]").forEach((function(n){var e=n.closest("[data-bf-product-id]");if(e){var r,o=e.getAttribute("data-bf-product-id"),i=t.productManager.currentProducts[o],a=null==i||null===(r=i.variants)||void 0===r||null===(r=r.edges)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.node;a&&a.availableForSale||(n.disabled=!0,n.innerHTML="Out of stock")}n.addEventListener("click",(function(e){e.preventDefault(),t.handleAddToCart(n)}))}))}},{key:"handleAddToCart",value:function(t){var n,e=this,r=t.closest("[data-bf-product-id]"),o=null==r?void 0:r.querySelector("[data-bf-qty]"),i=o?parseInt(o.value,10):1,a=this.productManager.currentProducts[r.dataset.bfProductId];if(a){var c=null==a||null===(n=a.variants)||void 0===n||null===(n=n.edges)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.node,u=null==c?void 0:c.id;if(!c||!c.availableForSale)return t.disabled=!0,void(t.innerHTML="Out of stock");u?(this.setButtonLoading(t,!0),this.cart.addToCart({variantId:u,quantity:i}).then((function(){t.innerHTML=e._checkSVG,setTimeout((function(){e.setButtonLoading(t,!1)}),1500),e.cartUI.openCartDrawer()})).catch((function(n){t.innerHTML="Error",setTimeout((function(){e.setButtonLoading(t,!1)}),1500),console.error("[Blink] Add to cart failed:",n)}))):console.error("[Blink] Missing variant id.")}else console.error("[Blink] Product not found in currentProducts:",r.dataset.bfProductId)}},{key:"setButtonLoading",value:function(t,n){n?(t.disabled=!0,t.classList.add("bf-loading"),t.dataset.originalText||(t.dataset.originalText=t.innerHTML),t.innerHTML=this._loaderSVG):(t.disabled=!1,t.classList.remove("bf-loading"),t.dataset.originalText&&(t.innerHTML=t.dataset.originalText,delete t.dataset.originalText))}}],n&&z(t.prototype,n),e&&z(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,r,o}();function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function Z(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return tt(l,"_invoke",function(e,r,o){var i,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,c=0,u=t,d.n=e,a}};function y(e,r){for(c=e,u=r,n=0;!f&&l&&!o&&n<s.length;n++){var o,i=s[n],y=d.p,p=i[2];e>3?(o=p===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,d.v=r,d.n=i[1]):y<p&&(o=e<3||i[0]>r||r>p)&&(i[4]=e,i[5]=r,d.n=p,c=0))}if(o||e>1)return a;throw f=!0,r}return function(o,s,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&y(s,p),c=s,u=p;(n=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(d.n=-1),y(c,u)):d.n=u:d.v=u);try{if(l=2,i){if(c||(o="next"),n=i[o]){if(!(n=n.call(i,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=i.return)&&n.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((n=(f=d.n<0)?u:e.call(r,d))!==a)break}catch(n){i=t,c=1,u=n}finally{l=1}}return{value:n,done:f}}}(e,o,i),!0),l}var a={};function c(){}function u(){}function l(){}n=Object.getPrototypeOf;var s=[][r]?n(n([][r]())):(tt(n={},r,(function(){return this})),n),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,tt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,tt(f,"constructor",l),tt(l,"constructor",u),u.displayName="GeneratorFunction",tt(l,o,"GeneratorFunction"),tt(f),tt(f,o,"Generator"),tt(f,r,(function(){return this})),tt(f,"toString",(function(){return"[object Generator]"})),(Z=function(){return{w:i,m:d}})()}function tt(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}tt=function(t,n,e,r){if(n)o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e;else{var i=function(n,e){tt(t,n,(function(t){return this._invoke(n,e,t)}))};i("next",0),i("throw",1),i("return",2)}},tt(t,n,e,r)}function nt(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function et(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,rt(r.key),r)}}function rt(t){var n=function(t,n){if("object"!=Y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=Y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==Y(n)?n:n+""}var ot=function(){return t=function t(){var n,e,r=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),t._instance)return t._instance;t._instance=this;var i=(null===(n=o.shopify)||void 0===n?void 0:n.token)||this._getTokenFromDOM(),c=(null===(e=o.shopify)||void 0===e?void 0:e.storeDomain)||this._getStoreDomainFromDOM();i&&c?(this.shopifyClient=new a({token:i,storeDomain:c}),this.productManager=new T(this.shopifyClient),this.cart=new G(this.shopifyClient,this.productManager),this.cartUI=new V(this.cart),this.productUI=new W(this.productManager,this.cart,this.cartUI,(function(){return r.cart._moneyFormat})),this.store={shopName:null,moneyFormat:null},this._init()):console.error("[Blink] Shopify Token or Store Domain not provided or found in DOM.")},n=[{key:"_init",value:(r=Z().m((function t(){var n,e,r,o;return Z().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,this.cart.init();case 1:return t.n=2,this.cartUI.init();case 2:return t.n=3,this.productUI.init();case 3:if(n=d.get("blink_shop_info"))try{e=n,this.store.shopName=e.shopName||null,this.store.moneyFormat=e.moneyFormat||null}catch(t){console.warn("[Blink] Invalid cached shop info, fetching fresh.")}if(this.store.shopName&&this.store.moneyFormat){t.n=5;break}return t.n=4,this.shopifyClient.executeQuery("\n            {\n                shop {\n                    name\n                    moneyFormat\n                }\n            }\n            ");case 4:null!=(o=t.v)&&null!==(r=o.data)&&void 0!==r&&r.shop&&(this.store.shopName=o.data.shop.name,this.store.moneyFormat=o.data.shop.moneyFormat,d.set("blink_shop_info",{shopName:this.store.shopName,moneyFormat:this.store.moneyFormat},36e5));case 5:return t.a(2)}}),t,this)})),o=function(){var t=this,n=arguments;return new Promise((function(e,o){var i=r.apply(t,n);function a(t){nt(i,e,o,a,c,"next",t)}function c(t){nt(i,e,o,a,c,"throw",t)}a(void 0)}))},function(){return o.apply(this,arguments)})},{key:"_getTokenFromDOM",value:function(){var t,n=document.querySelector('script[data-name="blink-main-script"]');return null!==(t=null==n?void 0:n.getAttribute("data-store-token"))&&void 0!==t?t:null}},{key:"_getStoreDomainFromDOM",value:function(){var t,n=document.querySelector('script[data-name="blink-main-script"]');return null!==(t=null==n?void 0:n.getAttribute("data-store-domain"))&&void 0!==t?t:null}}],n&&et(t.prototype,n),e&&et(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,r,o}();document.addEventListener("DOMContentLoaded",(function(){window.Blink=new ot}))})();